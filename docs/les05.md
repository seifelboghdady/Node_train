# üìò Project Documentation: Course Management API

## 1\. System Architecture

This project follows a **Modular Architecture** (specifically a variation of MVC). Instead of writing all code in one file, we separate "concerns" to make the application scalable and maintainable.

  * **Entry Point (`index.js`):** The boss. It starts the server and delegates requests to the routers.
  * **Router (`course.routes.js`):** The traffic cop. It looks at the URL and decides which controller function should handle it.
  * **Controller (`index.controler.js`):** The logic center. It processes data, applies business rules, and sends responses.
  * **Data Layer (`data.js`):** The storage. Currently an in-memory array, acting as a placeholder for a real database (like SQL or MongoDB).

-----

## 2\. Module Breakdown

### üìÇ File: `Data/data.js`

**Purpose:** Acts as a Mock Database.
This file exports a static array of objects. In a production environment, this file would be replaced by a database connection (e.g., Mongoose for MongoDB or Sequelize for SQL).

  * **Structure:** An array of 20 course objects containing `id`, `title`, and `coach`.

### üìÇ File: `index.js` (The Server)

**Purpose:** Application Entry Point.

  * **`express.json()`:** Middleware used to parse incoming JSON payloads (required for POST/PATCH requests).
  * **`app.use('/api/courses', router)`:** This mounts the course routes. It tells Express: *"Any request that starts with `/api/courses` should be handled by the `course.routes.js` file."*
  * **`app.listen(4000)`:** Starts the server on port 4000.

### üìÇ File: `Routes/course.routes.js`

**Purpose:** API Route Definitions & Validation Rules.
This file decouples routing from logic. It imports the Controller to handle the actual work.

| HTTP Verb | Endpoint Path | Description | Middleware Used |
| :--- | :--- | :--- | :--- |
| **GET** | `/` | Fetch all courses | None |
| **GET** | `/:courseid` | Fetch single course | None |
| **POST** | `/` | Create new course | `express-validator` (Checks if title exists and length \> 2) |
| **PATCH** | `/:id` | Update a course | None |

### üìÇ File: `Controls/index.controler.js`

**Purpose:** Business Logic (CRUD Operations).

#### 1\. `getCourses`

  * **Logic:** Returns the full list of courses from the data file.
  * **Response:** JSON Array `[]`.

#### 2\. `getCourse`

  * **Logic:** Searches the array using `.find()`.
  * **Input:** `req.params.courseid` (from the URL).
  * **Error Handling:** If the course is not found, it returns HTTP `404` (Not Found).

#### 3\. `addCourse`

  * **Logic:**
    1.  Checks for validation errors (generated by the router).
    2.  If errors exist, returns HTTP `400` (Bad Request).
    3.  If valid, it calculates a new ID (`length + 1`) and pushes the new object to the array.
  * **Senior Note:** This manual ID generation is common in training but risky in production (race conditions). Databases handle this automatically.

#### 4\. `updateCourse`

  * **Logic:** Finds a course by ID and attempts to update it.
  * **Current Behavior:** It merges the existing course data with `req.params`.

-----

## 3\. Senior Instructor Code Review & Debugging Notes

*Use this section to impress your instructor or fix bugs during your practice.*

**‚ö†Ô∏è Critical Bug Report (For your attention):**
I noticed two small bugs in the provided `index.controler.js` that will cause errors when you run this:

1.  **Validation Logic Error:**
    In `addCourse`, the code is `if(!errors.isEmpty)`.

      * *The Issue:* `isEmpty` is a function, so it must be called with parentheses.
      * *The Fix:* Change it to `if(!errors.isEmpty())`.

2.  **Update Logic Error:**
    In `updateCourse`, the code is `course = {...course, ...req.params};`.

      * *The Issue:* `req.params` contains the URL parameters (like `id: '1'`), but the *new data* (like the new title) usually comes in the `req.body`.
      * *The Fix:* It should likely be `course = {...course, ...req.body};`.

-----

## 4\. API Reference (How to test in Postman)

**Base URL:** `http://localhost:4000/api/courses`

### 1\. Get All Courses

  * **Method:** `GET`
  * **URL:** `/`

### 2\. Add New Course

  * **Method:** `POST`
  * **URL:** `/`
  * **Body (JSON):**
    ```json
    {
      "title": "Docker",
      "coach": "Hassan"
    }
    ```

### 3\. Get Single Course

  * **Method:** `GET`
  * **URL:** `/1` (Replace 1 with ID)

### 4\. Update Course

  * **Method:** `PATCH`
  * **URL:** `/1`
  * **Body (JSON):**
    ```json
    {
      "title": "Advanced HTML",
      "coach": "Seif"
    }
    ```
